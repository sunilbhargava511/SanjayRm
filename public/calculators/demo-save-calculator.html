<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Save Number Calculator</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Custom Styles -->
    <style>
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: #3B82F6;
            cursor: pointer;
            border: 2px solid #ffffff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .icon {
            display: inline-block;
            width: 1.25rem;
            height: 1.25rem;
            text-align: center;
            line-height: 1.25rem;
            font-size: 1rem;
        }
    </style>
</head>
<body>
    <div id="root">
        <div class="flex items-center justify-center min-h-screen bg-gray-100">
            <div class="text-center p-8">
                <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"></div>
                <p class="text-gray-600">Loading calculator...</p>
            </div>
        </div>
    </div>

    <!-- React Dependencies -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Application Code -->
    <script type="text/babel">
        // Mock module system
        if (typeof window.exports === 'undefined') {
            window.exports = {};
            window.module = { exports: window.exports };
        }

        

const SaveNumberCalculator = () => {
  // User Inputs
  const [currentAge, setCurrentAge] = useState(22);
  const [retireAge, setRetireAge] = useState(60);
  const [targetCorpus, setTargetCorpus] = useState(1.0);
  const [savingsIncrease, setSavingsIncrease] = useState(6.0);
  
  // Assumptions
  const [inflation, setInflation] = useState(6.0);
  const [returns, setReturns] = useState(11.0);
  
  // Results
  const [results, setResults] = useState(null);
  const [yearlyData, setYearlyData] = useState([]);

  // Format currency
  const formatINR = (amount) => {
    if (amount >= 10000000) {
      return `‚Çπ${(amount / 10000000).toFixed(2)} Cr`;
    } else if (amount >= 100000) {
      return `‚Çπ${(amount / 100000).toFixed(2)} L`;
    } else {
      return `‚Çπ${amount.toLocaleString('en-IN', { maximumFractionDigits: 0 })}`;
    }
  };

  // Core calculation function
  const calculateSaveNumber = () => {
    const years = retireAge - currentAge;
    const inflationDecimal = inflation / 100;
    const savingsIncreaseDecimal = savingsIncrease / 100;
    const returnDecimal = returns / 100;
    const monthlyReturn = Math.pow(1 + returnDecimal, 1/12) - 1;
    const targetRealRupees = targetCorpus * 10000000; // 1 crore = 10,000,000
    
    const simulate = (firstYearMonthly) => {
      let balance = 0;
      const yearlyBreakdown = [];
      let totalInvested = 0;
      let totalGain = 0;
      
      for (let year = 0; year < years; year++) {
        const beginBalance = balance;
        const monthlyContribution = firstYearMonthly * Math.pow(1 + savingsIncreaseDecimal, year);
        let yearInvested = 0;
        let yearGain = 0;
        
        // 12 months of contributions and growth
        for (let month = 0; month < 12; month++) {
          balance += monthlyContribution; // Beginning of month contribution
          yearInvested += monthlyContribution;
          totalInvested += monthlyContribution;
          
          const gain = balance * monthlyReturn;
          balance += gain;
          yearGain += gain;
          totalGain += gain;
        }
        
        const endNominal = balance;
        const endReal = endNominal / Math.pow(1 + inflationDecimal, year + 1);
        
        yearlyBreakdown.push({
          year: year + 1,
          beginCorpus: beginBalance,
          invested: yearInvested,
          gain: yearGain,
          endNominal: endNominal,
          endReal: endReal
        });
      }
      
      return { finalBalance: balance, yearlyBreakdown, totalInvested, totalGain };
    };
    
    const getFinalReal = (monthly) => {
      const { finalBalance } = simulate(monthly);
      return finalBalance / Math.pow(1 + inflationDecimal, years);
    };
    
    // Bisection method to find required monthly contribution
    let low = 0;
    let high = 1000;
    
    // Find upper bound
    while (getFinalReal(high) < targetRealRupees) {
      high *= 2;
      if (high > 1000000) break;
    }
    
    // Bisection
    let monthly = 0;
    for (let i = 0; i < 50; i++) {
      monthly = (low + high) / 2;
      const realValue = getFinalReal(monthly);
      
      if (Math.abs(realValue - targetRealRupees) < 1) {
        break;
      }
      
      if (realValue < targetRealRupees) {
        low = monthly;
      } else {
        high = monthly;
      }
    }
    
    const finalSimulation = simulate(monthly);
    const finalNominal = finalSimulation.finalBalance;
    const finalReal = finalNominal / Math.pow(1 + inflationDecimal, years);
    const percentInvested = (finalSimulation.totalInvested / finalNominal) * 100;
    const percentGained = (finalSimulation.totalGain / finalNominal) * 100;
    
    return {
      monthlyContribution: monthly,
      totalInvested: finalSimulation.totalInvested,
      totalGain: finalSimulation.totalGain,
      finalNominal: finalNominal,
      finalReal: finalReal,
      percentInvested: percentInvested,
      percentGained: percentGained,
      yearlyData: finalSimulation.yearlyBreakdown
    };
  };

  // Calculate when inputs change
  useEffect(() => {
    if (retireAge > currentAge && targetCorpus > 0) {
      const result = calculateSaveNumber();
      setResults(result);
      setYearlyData(result.yearlyData);
    }
  }, [currentAge, retireAge, targetCorpus, savingsIncrease, inflation, returns]);

  return (
    <div className="max-w-6xl mx-auto p-6 bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
      <div className="bg-white rounded-xl shadow-xl overflow-hidden">
        {/* Header */}
        <div className="bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-6">
          <div className="flex items-center space-x-3">
            <span class="icon">üßÆ</span>
            <div>
              <h1 className="text-2xl font-bold">Save Number Calculator</h1>
              <p className="text-blue-100">Calculate your monthly savings target for retirement in India</p>
            </div>
          </div>
        </div>

        <div className="p-6 space-y-8">
          {/* Main Content: Inputs on Left, Results on Right */}
          <div style={{ display: 'flex', flexDirection: 'row', gap: '2rem', flexWrap: 'wrap' }}>
            
            {/* LEFT COLUMN - ALL INPUTS */}
            <div className="flex-1 space-y-6">
              {/* User Inputs */}
              <div className="bg-green-50 rounded-lg p-6 border-l-4 border-green-500">
                <h2 className="text-lg font-semibold text-green-800 mb-4 flex items-center">
                  <span class="icon">üéØ</span>
                  Your Personal Goals
                </h2>
                
                <div className="space-y-6">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Current Age: {currentAge} years
                    </label>
                    <input
                      type="range"
                      min="0"
                      max="40"
                      value={currentAge}
                      onChange={(e) => setCurrentAge(parseInt(e.target.value))}
                      className="w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer"
                    />
                    <div className="flex justify-between text-xs text-gray-500 mt-1">
                      <span>0</span>
                      <span>40</span>
                    </div>
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Retirement Age: {retireAge} years
                    </label>
                    <input
                      type="range"
                      min={currentAge + 1}
                      max="80"
                      value={retireAge}
                      onChange={(e) => setRetireAge(parseInt(e.target.value))}
                      className="w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer"
                    />
                    <div className="flex justify-between text-xs text-gray-500 mt-1">
                      <span>{currentAge + 1}</span>
                      <span>80</span>
                    </div>
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Target Corpus: ‚Çπ{targetCorpus.toFixed(1)} Crore (today's value)
                    </label>
                    <input
                      type="range"
                      min="0.1"
                      max="10"
                      step="0.1"
                      value={targetCorpus}
                      onChange={(e) => setTargetCorpus(parseFloat(e.target.value))}
                      className="w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer"
                    />
                    <div className="flex justify-between text-xs text-gray-500 mt-1">
                      <span>‚Çπ0.1 Cr</span>
                      <span>‚Çπ10 Cr</span>
                    </div>
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Annual Savings Increase: {savingsIncrease.toFixed(1)}%
                    </label>
                    <input
                      type="range"
                      min="5"
                      max="30"
                      step="0.5"
                      value={savingsIncrease}
                      onChange={(e) => setSavingsIncrease(parseFloat(e.target.value))}
                      className="w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer"
                    />
                    <div className="flex justify-between text-xs text-gray-500 mt-1">
                      <span>5%</span>
                      <span>30%</span>
                    </div>
                    <div className="text-xs text-gray-600 mt-1">
                      Your contributions grow by this % each year (salary growth, promotions)
                    </div>
                  </div>
                </div>
              </div>

              {/* Economic Assumptions */}
              <div className="bg-orange-50 rounded-lg p-6 border-l-4 border-orange-500">
                <h2 className="text-lg font-semibold text-orange-800 mb-4 flex items-center">
                  <span class="icon">üìà</span>
                  Economic Assumptions
                </h2>
                
                <div className="space-y-6">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Annual Inflation: {inflation.toFixed(1)}%
                    </label>
                    <input
                      type="range"
                      min="2"
                      max="10"
                      step="0.1"
                      value={inflation}
                      onChange={(e) => setInflation(parseFloat(e.target.value))}
                      className="w-full h-2 bg-orange-200 rounded-lg appearance-none cursor-pointer"
                    />
                    <div className="flex justify-between text-xs text-gray-500 mt-1">
                      <span>2%</span>
                      <span>10%</span>
                    </div>
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Annual Returns: {returns.toFixed(1)}%
                    </label>
                    <input
                      type="range"
                      min="5"
                      max="15"
                      step="0.1"
                      value={returns}
                      onChange={(e) => setReturns(parseFloat(e.target.value))}
                      className="w-full h-2 bg-orange-200 rounded-lg appearance-none cursor-pointer"
                    />
                    <div className="flex justify-between text-xs text-gray-500 mt-1">
                      <span>5%</span>
                      <span>15%</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            {/* RIGHT COLUMN - RESULTS */}
            <div className="flex-1 space-y-6">
              {results && (
                <>
                  {/* Key Metrics */}
                  <div className="bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-6 border-l-4 border-purple-500">
                    <h2 className="text-xl font-bold text-purple-800 mb-4 flex items-center">
                      <span class="icon">‚Çπ</span>
                      Your Save Number Results
                    </h2>
                    
                    <div className="grid grid-cols-2 gap-4">
                      <div className="bg-white rounded-lg p-4 shadow">
                        <div className="text-sm text-gray-600">Monthly Save Number</div>
                        <div className="text-xl font-bold text-purple-600">
                          {formatINR(results.monthlyContribution)}
                        </div>
                        <div className="text-xs text-gray-500">First year amount</div>
                      </div>
                      
                      <div className="bg-white rounded-lg p-4 shadow">
                        <div className="text-sm text-gray-600">Total Invested</div>
                        <div className="text-lg font-bold text-blue-600">
                          {formatINR(results.totalInvested)}
                        </div>
                        <div className="text-xs text-gray-500">Over {retireAge - currentAge} years</div>
                      </div>
                      
                      <div className="bg-white rounded-lg p-4 shadow">
                        <div className="text-sm text-gray-600">Total Gains</div>
                        <div className="text-lg font-bold text-green-600">
                          {formatINR(results.totalGain)}
                        </div>
                        <div className="text-xs text-gray-500">Growth from returns</div>
                      </div>
                      
                      <div className="bg-white rounded-lg p-4 shadow">
                        <div className="text-sm text-gray-600">Final Corpus</div>
                        <div className="text-lg font-bold text-indigo-600">
                          {formatINR(results.finalNominal)}
                        </div>
                        <div className="text-xs text-gray-500">At age {retireAge}</div>
                      </div>
                    </div>
                  </div>

                  {/* Percentage Breakdown */}
                  <div className="bg-gradient-to-r from-cyan-50 to-blue-50 rounded-lg p-6 border-l-4 border-cyan-500">
                    <h2 className="text-lg font-bold text-cyan-800 mb-4 flex items-center">
                      <span class="icon">%</span>
                      Corpus Composition at Age {retireAge}
                    </h2>
                    
                    <div className="space-y-4">
                      <div className="bg-white rounded-lg p-4">
                        <div className="flex items-center justify-between mb-2">
                          <span className="text-sm font-medium text-gray-700">Amount Invested</span>
                          <span className="text-lg font-bold text-blue-600">
                            {results.percentInvested.toFixed(1)}%
                          </span>
                        </div>
                        <div className="w-full bg-gray-200 rounded-full h-3">
                          <div 
                            className="bg-blue-500 h-3 rounded-full transition-all duration-500"
                            style={{ width: `${results.percentInvested}%` }}
                          ></div>
                        </div>
                        <div className="text-xs text-gray-500 mt-1">
                          {formatINR(results.totalInvested)}
                        </div>
                      </div>
                      
                      <div className="bg-white rounded-lg p-4">
                        <div className="flex items-center justify-between mb-2">
                          <span className="text-sm font-medium text-gray-700">Growth/Returns</span>
                          <span className="text-lg font-bold text-green-600">
                            {results.percentGained.toFixed(1)}%
                          </span>
                        </div>
                        <div className="w-full bg-gray-200 rounded-full h-3">
                          <div 
                            className="bg-green-500 h-3 rounded-full transition-all duration-500"
                            style={{ width: `${results.percentGained}%` }}
                          ></div>
                        </div>
                        <div className="text-xs text-gray-500 mt-1">
                          {formatINR(results.totalGain)}
                        </div>
                      </div>
                    </div>
                  </div>
                </>
              )}
            </div>
          </div>

          {/* FULL WIDTH YEARLY BREAKDOWN TABLE */}
          {results && (
            <div className="bg-gray-50 rounded-lg p-6">
              <h2 className="text-lg font-bold text-gray-800 mb-4">Year-by-Year Breakdown</h2>
              <div className="overflow-x-auto">
                <table className="w-full text-sm">
                  <thead>
                    <tr className="bg-gray-200">
                      <th className="p-3 text-left">Year</th>
                      <th className="p-3 text-right">Amount Invested</th>
                      <th className="p-3 text-right">Corpus Gain</th>
                      <th className="p-3 text-right">End Corpus (Nominal)</th>
                      <th className="p-3 text-right">End Corpus (Real)</th>
                    </tr>
                  </thead>
                  <tbody>
                    {yearlyData.slice(0, 10).map((row, index) => (
                      <tr key={index} className="border-b hover:bg-gray-100">
                        <td className="p-3 font-medium">{row.year}</td>
                        <td className="p-3 text-right">{formatINR(row.invested)}</td>
                        <td className="p-3 text-right text-green-600">{formatINR(row.gain)}</td>
                        <td className="p-3 text-right font-medium">{formatINR(row.endNominal)}</td>
                        <td className="p-3 text-right text-blue-600">{formatINR(row.endReal)}</td>
                      </tr>
                    ))}
                    {yearlyData.length > 10 && (
                      <tr>
                        <td colSpan="5" className="p-3 text-center text-gray-500 italic">
                          ... and {yearlyData.length - 10} more years
                        </td>
                      </tr>
                    )}
                  </tbody>
                </table>
              </div>
            </div>
          )}
        </div>
      </div>
    </div>
  );
};

window.Calculator = SaveNumberCalculator;
        
        // Mount component
        const root = ReactDOM.createRoot(document.getElementById('root'));
        
        if (typeof window.Calculator === 'function') {
            root.render(React.createElement(window.Calculator));
            console.log('‚úÖ Calculator component mounted successfully');
        } else if (typeof window.SaveNumberCalculator === 'function') {
            root.render(React.createElement(window.SaveNumberCalculator));
            console.log('‚úÖ SaveNumberCalculator component mounted successfully');
        } else {
            console.error('‚ùå No component found to mount');
            document.getElementById('root').innerHTML = 
                '<div class="text-center p-8">' +
                '<h2 class="text-xl font-bold text-red-600">Component Error</h2>' +
                '<p>Could not find component to render.</p>' +
                '<p>Available: ' + Object.keys(window).filter(k => typeof window[k] === 'function' && /^[A-Z]/.test(k)).join(', ') + '</p>' +
                '</div>';
        }

        // Error handling
        window.addEventListener('error', (e) => {
            console.error('üí• Runtime error:', e.error);
        });
    </script>
</body>
</html>